
Lustre : Current Project Quota information for projects you're a member of:

Name                           Type     Filesystem          Used          Quota           Grace
===============================================================================================
RAN                         Project     grand             682.3G             5T               -
datascience                 Project     grand             130.9T           200T               -
Comp_Perf_Workshop          Project     grand             194.7G             1T               -
CSC250STDM10                Project     grand             4.383G            16T               -
SDL_Workshop                Project     grand             271.1G             1T               -
ATPESC_Instructors          Project     grand             41.16M             1T               -
PolarisAT                   Project     grand             1.717P             3P               -
ATPESC2022                  Project     grand             662.5G             1T               -
sn_training                 Project     grand                 4k             1T               -
alcf_training               Project     grand            5.597G*             1M               -
WALSforAll                  Project     grand             3.037G             1T               -
datascience                 Project     eagle             94.91T           160T               -
SDL_Workshop                Project     eagle            13.64T*             1T               -
PolarisAT                   Project     eagle             213.7T           1.5P               -
PolarisAT                   Project     swift             277.4G             0k               -

Lustre : Current Project Quota information for projects you're a member of:

Name                           Type     Filesystem          Used          Quota           Grace
===============================================================================================
RAN                         Project     grand             682.3G             5T               -
datascience                 Project     grand             130.9T           200T               -
Comp_Perf_Workshop          Project     grand             194.7G             1T               -
CSC250STDM10                Project     grand             4.383G            16T               -
SDL_Workshop                Project     grand             271.1G             1T               -
ATPESC_Instructors          Project     grand             41.16M             1T               -
PolarisAT                   Project     grand             1.717P             3P               -
ATPESC2022                  Project     grand             662.5G             1T               -
sn_training                 Project     grand                 4k             1T               -
alcf_training               Project     grand            5.597G*             1M               -
WALSforAll                  Project     grand             3.037G             1T               -
datascience                 Project     eagle             94.91T           160T               -
SDL_Workshop                Project     eagle            13.64T*             1T               -
PolarisAT                   Project     eagle             213.7T           1.5P               -
PolarisAT                   Project     swift             277.4G             0k               -

Lustre : Current Project Quota information for projects you're a member of:

Name                           Type     Filesystem          Used          Quota           Grace
===============================================================================================
RAN                         Project     grand             682.3G             5T               -
datascience                 Project     grand             130.9T           200T               -
Comp_Perf_Workshop          Project     grand             194.7G             1T               -
CSC250STDM10                Project     grand             4.383G            16T               -
SDL_Workshop                Project     grand             271.1G             1T               -
ATPESC_Instructors          Project     grand             41.16M             1T               -
PolarisAT                   Project     grand             1.717P             3P               -
ATPESC2022                  Project     grand             662.5G             1T               -
sn_training                 Project     grand                 4k             1T               -
alcf_training               Project     grand            5.597G*             1M               -
WALSforAll                  Project     grand             3.037G             1T               -
datascience                 Project     eagle             94.91T           160T               -
SDL_Workshop                Project     eagle            13.64T*             1T               -
PolarisAT                   Project     eagle             213.7T           1.5P               -
PolarisAT                   Project     swift             277.4G             0k               -

Lustre : Current Project Quota information for projects you're a member of:

Name                           Type     Filesystem          Used          Quota           Grace
===============================================================================================
RAN                         Project     grand             682.3G             5T               -
datascience                 Project     grand             130.9T           200T               -
Comp_Perf_Workshop          Project     grand             194.7G             1T               -
CSC250STDM10                Project     grand             4.383G            16T               -
SDL_Workshop                Project     grand             271.1G             1T               -
ATPESC_Instructors          Project     grand             41.16M             1T               -
PolarisAT                   Project     grand             1.717P             3P               -
ATPESC2022                  Project     grand             662.5G             1T               -
sn_training                 Project     grand                 4k             1T               -
alcf_training               Project     grand            5.597G*             1M               -
WALSforAll                  Project     grand             3.037G             1T               -
datascience                 Project     eagle             94.91T           160T               -
SDL_Workshop                Project     eagle            13.64T*             1T               -
PolarisAT                   Project     eagle             213.7T           1.5P               -
PolarisAT                   Project     swift             277.4G             0k               -
source-ing /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/ALCF/launch.sh
source-ing /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/ALCF/args.sh
------------------------
SCRIPT_DIR=/lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/ALCF
SCRIPT_PATH=/lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/ALCF/args.sh
------------------------
SOURCE=/lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/ALCF/args.sh
DIR=/lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/ALCF
------------------------
source-ing /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/ALCF/setup.sh
USING PYTHON: /usr/bin/python3
CFLAGS: -I/include/
LDFLAGS: -L/lib/
Setting up MPI on Polaris from x3106c0s19b1n0
*******************************
USING HOSTFILE: /var/spool/pbs/aux/560611.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov
*******************************
source-ing /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/ALCF/model.sh
Kaushik
8
OUTPUT TO: /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/outputs/GPT3_actCkpt_flashAttn_175B_z1_seqlen2048_mp8_pp16_nl96_hs12288_gb8_mb1_gas8
megatron args:     --use-flash-attn         --checkpoint-activations       --seed 27617   --DDP-impl local   --pipeline-model-parallel-size 16   --tensor-model-parallel-size 8   --num-layers 96   --hidden-size 12288   --num-attention-heads 96   --micro-batch-size 1   --global-batch-size 8   --seq-length 2048   --max-position-embeddings 2048   --train-iters 5   --lr-decay-iters 320000   --data-path /lus/grand/projects/datascience/vsastry/genslm_subsample_200k_sequence_document/genslm_subsample_200k_sequence_document   --vocab-file /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/dataset/gpt2-vocab.json   --merge-file /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/dataset/gpt2-merges.txt   --data-impl mmap   --split 949,50,1   --distributed-backend nccl   --lr 0.00015   --lr-decay-style cosine   --min-lr 1.0e-5   --weight-decay 1e-2   --clip-grad 1.0   --lr-warmup-fraction .01   --log-interval 1   --save-interval 1000   --eval-interval 1000   --eval-iters 1   --tensorboard-dir /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/outputs/GPT3_actCkpt_flashAttn_175B_z1_seqlen2048_mp8_pp16_nl96_hs12288_gb8_mb1_gas8/tensorboard   --log-timers-to-tensorboard   --tensorboard-log-interval 1 --fp16
Setting up Polaris from x3106c0s19b1n0
Loading: 'module load conda 2023-01-10-unstable ; conda activate base'
Found venv at: /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/venvs/polaris/2023-01-10/
Requirement already satisfied: flash-attn in ./venvs/polaris/2023-01-10/lib/python3.10/site-packages (2.0.0.post1)
Requirement already satisfied: torch in /soft/datascience/conda/2023-01-10/mconda3/lib/python3.10/site-packages (from flash-attn) (1.13.0a0+git49444c3)
Requirement already satisfied: einops in ./venvs/polaris/2023-01-10/lib/python3.10/site-packages (from flash-attn) (0.6.1)
Requirement already satisfied: packaging in /soft/datascience/conda/2023-01-10/mconda3/lib/python3.10/site-packages (from flash-attn) (21.3)
Requirement already satisfied: ninja in /soft/datascience/conda/2023-01-10/mconda3/lib/python3.10/site-packages (from flash-attn) (1.11.1)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /soft/datascience/conda/2023-01-10/mconda3/lib/python3.10/site-packages (from packaging->flash-attn) (3.0.9)
Requirement already satisfied: typing-extensions in /soft/datascience/conda/2023-01-10/mconda3/lib/python3.10/site-packages (from torch->flash-attn) (4.4.0)
Package                           Version
--------------------------------- --------------------
absl-py                           1.4.0
accelerate                        0.16.0
aim                               3.16.0
aim-ui                            3.16.0
aimrecords                        0.0.7
aimrocks                          0.3.1
aiofiles                          22.1.0
aiohttp                           3.8.3
aiohttp-cors                      0.7.0
aiosignal                         1.3.1
alembic                           1.9.3
altair                            4.2.2
antlr4-python3-runtime            4.9.3
anyio                             3.6.2
apex                              0.1
appdirs                           1.4.4
argon2-cffi                       21.3.0
argon2-cffi-bindings              21.2.0
arviz                             0.14.0
asgiref                           3.6.0
asttokens                         2.2.1
astunparse                        1.6.3
async-timeout                     4.0.2
attrs                             22.2.0
backcall                          0.2.0
backoff                           2.2.1
base58                            2.0.1
beautifulsoup4                    4.11.1
bleach                            6.0.0
blessed                           1.20.0
blinker                           1.5
bokeh                             3.0.3
brotlipy                          0.7.0
cached-property                   1.5.2
cachetools                        5.3.0
celerite                          0.4.2
certifi                           2022.12.7
cffi                              1.15.1
cftime                            1.6.2
chardet                           4.0.0
charset-normalizer                2.0.4
chex                              0.1.6
click                             8.1.3
cloudpickle                       2.2.1
colorama                          0.4.6
coloredlogs                       15.0.1
colorful                          0.5.5
colorlog                          6.7.0
comm                              0.1.2
conda                             23.1.0
conda-build                       3.23.3
conda-content-trust               0.1.3
conda-package-handling            1.9.0
ConfigSpace                       0.6.1
contextlib2                       21.6.0
contourpy                         1.0.7
copulas                           0.8.0
cryptography                      38.0.1
ctgan                             0.7.0
cupy-cuda11x                      11.5.0
cycler                            0.11.0
Cython                            0.29.33
datasets                          2.9.0
debugpy                           1.6.6
decorator                         5.1.1
deepecho                          0.4.0
deephyper                         0.4.3
deepspeed                         0.9.0
defusedxml                        0.7.1
dill                              0.3.6
distlib                           0.3.6
Django                            4.1.6
dm-tree                           0.1.8
docker-pycreds                    0.4.0
docopt                            0.6.2
einops                            0.6.1
entrypoints                       0.4
etils                             1.0.0
evaluate                          0.4.0
exceptiongroup                    1.1.0
executing                         1.2.0
Faker                             14.2.1
fastapi                           0.89.1
fastjsonschema                    2.16.2
fastrlock                         0.8.1
filelock                          3.9.0
flash-attn                        2.0.0.post1
flatbuffers                       2.0.7
flax                              0.6.4
fonttools                         4.38.0
frozenlist                        1.3.3
fsspec                            2023.1.0
future                            0.18.2
gast                              0.4.0
gitdb                             4.0.10
GitPython                         3.1.30
glob2                             0.7
google-api-core                   2.11.0
google-auth                       2.16.0
google-auth-oauthlib              0.4.6
google-pasta                      0.2.0
googleapis-common-protos          1.58.0
gpustat                           1.0.0
gpytorch                          1.9.1
graphviz                          0.20.1
greenlet                          2.0.2
grpcio                            1.51.1
gviz-api                          1.10.0
h11                               0.14.0
h5py                              3.8.0
hjson                             3.1.0
horovod                           0.27.0
huggingface-hub                   0.12.0
humanfriendly                     10.0
hydra-colorlog                    1.2.0
hydra-core                        1.3.1
idna                              3.4
imageio                           2.25.0
importlib-metadata                6.0.0
importlib-resources               5.10.2
iniconfig                         2.0.0
ipykernel                         6.21.1
ipython                           8.9.0
ipython-genutils                  0.2.0
ipywidgets                        8.0.4
jax                               0.4.2
jaxlib                            0.4.2+cuda11.cudnn86
jedi                              0.18.2
Jinja2                            3.0.3
joblib                            1.2.0
jsonpickle                        3.0.1
jsonschema                        4.17.3
jupyter                           1.0.0
jupyter_client                    8.0.2
jupyter-console                   6.4.4
jupyter-contrib-core              0.4.2
jupyter-contrib-nbextensions      0.5.1
jupyter_core                      5.2.0
jupyter-highlight-selected-word   0.2.0
jupyter-latex-envs                1.4.6
jupyter-nbextensions-configurator 0.6.1
jupyter-server                    1.15.6
jupyterlab-widgets                3.0.5
keras                             2.11.0
Keras-Applications                1.0.8
Keras-Preprocessing               1.1.2
kiwisolver                        1.4.4
libarchive-c                      2.9
libclang                          15.0.6.1
libensemble                       0.9.3
libmambapy                        1.3.0
lightning-utilities               0.6.0.post0
line-profiler                     4.0.2
linear-operator                   0.3.0
llvmlite                          0.39.1
lxml                              4.9.2
Mako                              1.2.4
mamba                             1.3.0
Markdown                          3.4.1
markdown-it-py                    2.1.0
MarkupSafe                        2.1.1
matplotlib                        3.6.3
matplotlib-inline                 0.1.6
matplotx                          0.3.10
mdurl                             0.1.2
mistune                           0.8.4
mkl-fft                           1.3.1
mkl-random                        1.2.2
mkl-service                       2.4.0
ml-collections                    0.1.1
mock                              5.0.1
monotonic                         1.6
more-itertools                    9.0.0
mpi4jax                           0.3.11.post2
mpi4py                            3.1.4
mpmath                            1.2.1
msgpack                           1.0.4
multidict                         6.0.4
multipledispatch                  0.6.0
multiprocess                      0.70.14
munch                             2.5.0
nbclassic                         0.4.8
nbconvert                         5.6.1
nbformat                          5.7.3
nest-asyncio                      1.5.6
netCDF4                           1.6.2
networkx                          3.0
ninja                             1.11.1
nodeenv                           1.7.0
notebook                          6.5.2
notebook_shim                     0.2.2
numba                             0.56.4
numpy                             1.23.5
numpyro                           0.11.0
nvidia-ml-py                      11.495.46
oauthlib                          3.2.2
omegaconf                         2.3.0
onnx                              1.12.0
onnx-tf                           1.10.0
onnxruntime-gpu                   1.12.1
opencensus                        0.11.1
opencensus-context                0.1.3
opencv-python-headless            4.7.0.68
opt-einsum                        3.3.0
optax                             0.1.4
orbax                             0.1.1
packaging                         21.3
pandas                            1.5.3
pandocfilters                     1.5.0
parse                             1.19.0
parso                             0.8.3
pathtools                         0.1.2
pexpect                           4.8.0
pickleshare                       0.7.5
Pillow                            9.4.0
pip                               23.2
pkginfo                           1.8.3
platformdirs                      3.0.0
plotly                            5.13.0
pluggy                            1.0.0
portpicker                        1.5.2
prometheus-client                 0.13.1
promise                           2.3
prompt-toolkit                    3.0.36
protobuf                          3.19.6
psutil                            5.9.4
ptyprocess                        0.7.0
pure-eval                         0.2.2
py-cpuinfo                        9.0.0
py-spy                            0.3.14
py3nvml                           0.2.7
py4j                              0.10.9.7
pyarrow                           11.0.0
pyasn1                            0.4.8
pyasn1-modules                    0.2.8
pybind11                          2.11.1
pycosat                           0.6.4
pycparser                         2.21
pydantic                          1.10.4
pydeck                            0.8.0
pydot                             1.4.2
pyg-lib                           0.1.0+pt113cu117
Pygments                          2.14.0
pymongo                           3.12.0
Pympler                           1.0.1
pyOpenSSL                         22.0.0
pyparsing                         3.0.9
pyright                           1.1.292
pyrsistent                        0.19.3
PySocks                           1.7.1
pytest                            7.2.1
python-dateutil                   2.8.2
python-decouple                   3.7
pytorch-lightning                 1.9.0
pytz                              2022.7
pytz-deprecation-shim             0.1.0.post0
PyWavelets                        1.4.1
PyYAML                            6.0
pyzmq                             25.0.0
qtconsole                         5.4.0
QtPy                              2.3.0
ray                               2.2.0
rdt                               1.3.0
regex                             2022.10.31
requests                          2.28.1
requests-oauthlib                 1.3.1
responses                         0.18.0
RestrictedPython                  6.0
rich                              13.3.1
rsa                               4.9
ruamel.yaml                       0.17.21
ruamel.yaml.clib                  0.2.6
sacred                            0.8.4
scikit-image                      0.19.3
scikit-learn                      1.2.1
scipy                             1.10.0
sdmetrics                         0.9.0
sdv                               0.18.0
seaborn                           0.12.2
segment-analytics-python          2.2.2
semver                            2.13.0
Send2Trash                        1.8.0
sentry-sdk                        1.15.0
setproctitle                      1.3.2
setuptools                        68.0.0
six                               1.16.0
smart-open                        6.3.0
smmap                             5.0.0
sniffio                           1.3.0
soupsieve                         2.3.2.post1
SQLAlchemy                        1.4.46
sqlparse                          0.4.3
stack-data                        0.6.2
starlette                         0.22.0
streamlit                         1.17.0
streamlit-aggrid                  0.3.3
sympy                             1.11.1
tenacity                          8.2.0
tensorboard                       2.11.2
tensorboard-data-server           0.6.1
tensorboard-plugin-profile        2.11.1
tensorboard-plugin-wit            1.8.1
tensorflow                        2.11.0
tensorflow-addons                 0.19.0
tensorflow-datasets               4.8.2
tensorflow-estimator              2.11.0
tensorflow-io-gcs-filesystem      0.30.0
tensorflow-metadata               1.12.0
tensorflow-probability            0.19.0
tensorstore                       0.1.31
termcolor                         2.2.0
terminado                         0.17.1
testpath                          0.6.0
tf2onnx                           1.13.0
threadpoolctl                     3.1.0
tifffile                          2023.2.3
timm                              0.6.12
tinydb                            4.7.1
tokenizers                        0.13.2
toml                              0.10.2
tomli                             2.0.1
toolz                             0.12.0
torch                             1.13.0a0+git49444c3
torch-geometric                   2.2.0
torch-scatter                     2.1.0+pt113cu117
torch-sparse                      0.6.16+pt113cu117
torch-tb-profiler                 0.4.1
torchinfo                         1.7.2
torchmetrics                      0.11.1
torchvision                       0.14.1a0+5e8e2f1
torchviz                          0.0.2
tornado                           6.2
tqdm                              4.64.1
traitlets                         5.9.0
transformers                      4.26.0
triton                            1.0.0
typeguard                         2.13.3
typing_extensions                 4.4.0
tzdata                            2022.7
tzlocal                           4.2
urllib3                           1.26.13
uvicorn                           0.20.0
validators                        0.20.0
virtualenv                        20.19.0
wandb                             0.13.10
watchdog                          2.2.1
wcwidth                           0.2.6
webencodings                      0.5.1
websocket-client                  1.5.1
Werkzeug                          2.2.2
wheel                             0.40.0
widgetsnbextension                4.0.5
wrapt                             1.14.1
xarray                            2023.2.0
xarray-einstats                   0.5.1
xgboost                           1.7.3
xmltodict                         0.13.0
xxhash                            3.2.0
xyzservices                       2022.9.0
yarl                              1.8.2
zipp                              3.12.1
USING PYTHON: /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/venvs/polaris/2023-01-10/bin/python3
*******************************
USING HOSTFILE: /var/spool/pbs/aux/560611.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov
*******************************
NUM_HOSTS: 32, NGPU_PER_HOST: 4, NGPUS: 128
    Running on 32 hosts     with 4 GPUs each     for a total of 128 GPUs
*************************************************
Writing logs to: /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/outputs/GPT3_actCkpt_flashAttn_175B_z1_seqlen2048_mp8_pp16_nl96_hs12288_gb8_mb1_gas8/logs/kaushikvelusamy-x3106c0s19b1n0-nhosts32-ngpu128-2023-07-21-213505.log
*************************************************
WORLD_SIZE: 128
NHOSTS: 32
NGPUS: 128
TPSIZE: 8
PPSIZE: 16
MICRO_BATCH: 1
GRADIENT_ACCUMULATION_STEPS: 8
--------------------------------
GLOBAL_BATCH=8 
GLOBAL_BATCH=128 * 1 * 8 / (8 * 16)
--------------------------------
Job started at: 2023-07-21-213505 on x3106c0s19b1n0
Job running in: /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/ALCF
Training GPT-3 with 175B parameters
Writing logs in: /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/outputs/GPT3_actCkpt_flashAttn_175B_z1_seqlen2048_mp8_pp16_nl96_hs12288_gb8_mb1_gas8
LOGFILE: /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/outputs/GPT3_actCkpt_flashAttn_175B_z1_seqlen2048_mp8_pp16_nl96_hs12288_gb8_mb1_gas8/logs/kaushikvelusamy-x3106c0s19b1n0-nhosts32-ngpu128-2023-07-21-213505.log
to view output: tail -f $(tail -1 logfiles)
i.e. tail -f /lus/grand/projects/datascience/kaushikv/dlio/ml_workloads/gpt-alcf/Megatron-DeepSpeed/outputs/GPT3_actCkpt_flashAttn_175B_z1_seqlen2048_mp8_pp16_nl96_hs12288_gb8_mb1_gas8/logs/kaushikvelusamy-x3106c0s19b1n0-nhosts32-ngpu128-2023-07-21-213505.log
